doctype html
html(lang=en)
  include ../partials/head
  
body
  include ../partials/nav

  main.main--add-author
    div.mdl-grid
      div.mdl-cell--4-col.mdl-cell--8-col-tablet.mdl-cell--4-col-phone
        form#add-author__form(action="/authors", method="POST")
        
            div.mdl-textfield.mdl-js-textfield.mdl-textfield--floating-label
              input#title.mdl-textfield__input(type="text", name="title")
              label.mdl-textfield__label.g-reads-label--dark(for="title") Title
              span.mdl-textfield__error Please enter a title/span

            div.mdl-textfield.mdl-js-textfield.mdl-textfield--floating-label
              label.mdl-textfield__label.g-reads-label--dark(for="genre") Genre/label
              input#genre.mdl-textfield__input(type="text", name="genre")
              span.mdl-textfield__error Please enter at least one genre/span

            div.mdl-textfield.mdl-js-textfield.mdl-textfield--floating-label
              input#coverImage.mdl-textfield__input(name="coverImage" type="text")
              label.mdl-textfield__label.g-reads-label--dark(for="coverImage") Cover Image/label
              span.mdl-textfield__error Please enter a url for a cover image

            div.mdl-textfield.mdl-js-textfield
              textarea#description.mdl-textfield__input(name="description", type="text")
              label.mdl-textfield__label.g-reads-label--dark(for="description") Description/label
              span.mdl-textfield__error Please enter a description/span
            // insert script to add more authors to form
            div#booksWritten

            div.add-books-written
              div.mdl-grid
                div.mdl-cell.mdl-cell--10-col.mdl-cell--4-col-tablet.mdl-cell--3-col-phone
                  div.mdl-textfield.mdl-js-textfield.mdl-textfield--floating-label
                    input#booksInput.mdl-textfield__input(name="booksInput", type="text")
                    label.mdl-textfield__label.g-reads-label--dark(for="description") Book(s) written
                    span.mdl-textfield__error Please enter a url for a cover image
                div.mdl-cell.mdl-cell--1-col.mdl-cell--1-col-tablet.mdl-cell--1-col-phone
                  button#addBooks.mdl-button.mdl-js-button.mdl-button--fab.mdl-js-ripple-effect
                    i.material-icons add

                  span.mdl-textfield__error Please enter at least one author

            button#addAuthor.mdl-button.mdl-js-button.mdl-button--raised.mdl-button--accent.mdl-js-ripple-effect(type="submit") Add Author

  include ../partials/footer
  
  script(type=javascript).
  
    var addAuthorForm = document.getElementById('add-author__form');
    var addBooksBtn = document.getElementById('addBooks');
    var addBooksInput = document.getElementById('booksInput');
    var booksWritten = document.getElementById('booksWritten');
    
    function addBookBlock(bookTitle) {
      function newEl(el) {
        return document.createElement(el);
      }
      var newGrid = newEl("div");
      var leftCol = newEl("div");
      var rightCol = newEl("div");
      var input = newEl("input");
      
      input.setAttribute("value", bookTitle);
      input.setAttribute("name", "bookTitle");
      input.className = "mdl-textfield__input";
      
      newGrid.className = "mdl-grid";
      leftCol.className = "mdl-cell mdl-cell--10-col mdl-cell--4-col-tablet mdl-cell--3-col-phone";
      rightCol.className = "mdl-cellmdl-cell--1-col mdl-cell--1-col-tablet mdl-cell--1-col-phone";
      
      rightCol.innerHTML = "<a href=''><i class='material-icons remove-book'>clear</i></a>";
      leftCol.appendChild(input);
      newGrid.appendChild(leftCol);
      newGrid.appendChild(rightCol);
      booksWritten.appendChild(newGrid);
    }
    
    addBooksBtn.addEventListener('click', function(e) {
      e.preventDefault();
      
      if (addBooksInput.value === '' || addBooksInput.value === null) {
        addBooksInput.parentNode.classList.add('is-invalid');
      } 
      else {
        addBookBlock(addBooksInput.value);
        addBooksInput.value = '';
      }
    });
    
    booksWritten.addEventListener('click', function(e) {
      e.preventDefault();
      
      console.log(this);
      console.log(e.target.classList.contains('remove-book'));
      
      if (e.target.classList.contains('remove-book')) {
        console.log(e.target.parentElement.parentElement.parentElement);
        this.removeChild(e.target.parentElement.parentElement.parentElement);
        e.stopPropagation();  
      }
    });

    addAuthorForm.addEventListener('submit', function(e) {
      validateAuthorForm();
      console.log('submitted');
    });
